<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Statik - Google Sheets Database</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding: 20px; }
        .container { max-width: 600px; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .data-list { margin-top: 30px; }
        #loading { display: none; }
    </style>
</head>
<body>

<div class="container">
    <h3 class="text-center mb-4">Form Input Data</h3>
    
    <form id="formInput">
        <div class="mb-3">
            <label class="form-label">Nama Lengkap</label>
            <input type="text" id="nama" class="form-control" placeholder="Contoh: Budi Santoso" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Email</label>
            <input type="email" id="email" class="form-control" placeholder="name@example.com" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Pesan</label>
            <textarea id="pesan" class="form-control" rows="3" placeholder="Tulis pesan Anda..."></textarea>
        </div>
        <button type="submit" id="btnKirim" class="btn btn-primary w-100">Kirim Data</button>
        <div id="loading" class="text-center mt-2 text-muted">Sedang mengirim...</div>
    </form>

    <hr class="my-5">

    <div class="data-list">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h4>Daftar Data</h4>
            <button onclick="ambilData()" class="btn btn-sm btn-outline-secondary">Refresh Data</button>
        </div>
        <div id="containerData" class="list-group">
            <p class="text-muted text-center">Belum ada data atau klik refresh.</p>
        </div>
    </div>
</div>

<script>
    // GANTI URL DI BAWAH INI DENGAN URL WEB APP KAMU!
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyGnPnw3NXxlNojA96J6s69AQczzHraw2OkfezuGIIW7ym0Mw2WM0a_8XgephlIMCchjw/exec';

    // LOGIKA KIRIM DATA (POST)
    const form = document.getElementById('formInput');
    const btnKirim = document.getElementById('btnKirim');
    const loading = document.getElementById('loading');

    form.addEventListener('submit', e => {
        e.preventDefault();
        btnKirim.disabled = true;
        loading.style.display = 'block';

        const payload = {
            nama: document.getElementById('nama').value,
            email: document.getElementById('email').value,
            pesan: document.getElementById('pesan').value
        };

        fetch(scriptURL, {
            method: 'POST',
            body: JSON.stringify(payload)
        })
        .then(response => {
            alert("Berhasil tersimpan di Spreadsheet!");
            form.reset();
            ambilData(); // Refresh list setelah input
        })
        .catch(error => alert("Gagal mengirim data!"))
        .finally(() => {
            btnKirim.disabled = false;
            loading.style.display = 'none';
        });
    });

    // LOGIKA AMBIL DATA (GET)
    function ambilData() {
        const container = document.getElementById('containerData');
        container.innerHTML = '<p class="text-center">Memuat data...</p>';

        fetch(scriptURL)
            .then(res => res.json())
            .then(data => {
                if (data.length === 0) {
                    container.innerHTML = '<p class="text-center">Database kosong.</p>';
                    return;
                }
                
                container.innerHTML = data.reverse().map(row => `
                    <div class="list-group-item">
                        <h6 class="mb-1">${row[0]}</h6>
                        <p class="mb-1 text-muted small">${row[1]}</p>
                        <small>"${row[2]}"</small>
                    </div>
                `).join('');
            })
            .catch(err => {
                container.innerHTML = '<p class="text-danger">Gagal memuat data.</p>';
            });
    }

    // Ambil data otomatis saat web dibuka
    window.onload = ambilData;
</script>

</body>
</html>
